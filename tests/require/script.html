<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>QUnit</title>
	<script>function base(level){document.write("<base href=\""+location.href.replace(/\/[^\/]*$/,"/")+level+"\"/>")}</script>
	<script>
	base("../../");

	var require = {
			baseUrl: "src",
		};
	</script>
	<link  href="external/qunit/qunit/qunit.css" rel="stylesheet"/>
	<script src="external/qunit/qunit/qunit.js"></script>
	<script src="src/require.js"></script>
</head>
<body>
	<h1 id="qunit-header">QUnit</h1>
	<h2 id="qunit-banner"></h2>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	<div id="qunit-fixture">test markup, will be hidden</div>
	<script>
	var moduleName = "script";

	module(moduleName);

	(function(){

		var t = {};

		define("script!A", [], function(){
			t.definedA = "DEFINED: script!A";
			return "SCRIPT MODULE A";
		});


		define("require/script!B", [], function(){
			t.definedB = "DEFINED: require/script!B";
			return "SCRIPT MODULE B";
		});

		asyncTest("define(\"script!\"); require(\"script!\")", function() {
			require(["script!A"], function(moduleA){
				t.loadedA = "LOADED: script!A > " + moduleA;

				equal(
					t.definedA,
					"DEFINED: script!A",
					"define(\"script!A\", ... ); --> script!A was defined"
				);

				equal(
					t.loadedA,
					"LOADED: script!A > SCRIPT MODULE A",
					"define(\"script!A\", ... ); --> script!A was loaded as module object"
				);

				start();
			});
		});

		asyncTest("define(\"script!\"); require(\"require/script!\")", function() {
			require(["script!A"], function(moduleA){
				t.loadedA = "LOADED: script!A > " + moduleA;

				equal(
					t.definedA,
					"DEFINED: script!A",
					"define(\"script!A\", ... ); --> require/script!A was defined"
				);

				equal(
					t.loadedA,
					"LOADED: script!A > SCRIPT MODULE A",
					"define(\"script!A\", ... ); --> require/script!A was loaded as module object"
				);

				start();
			});
		});

		asyncTest("define(\"require/script!\"); require(\"script!\")", function() {
			require(["script!B"], function(moduleB){
				t.loadedB = "LOADED: require/script!B > " + moduleB;

				equal(
					t.definedB,
					"DEFINED: require/script!B",
					"define(\"require/script!B\", ... ); --> script!B was defined"
				);

				equal(
					t.loadedB,
					"LOADED: require/script!B > SCRIPT MODULE B",
					"define(\"require/script!B\", ... ); --> script!B was loaded as module object"
				);

				start();
			});
		});

		asyncTest("define(\"require/script!\"); require(\"require/script!\")", function() {
			require(["require/script!B"], function(moduleB){
				t.loadedB = "LOADED: require/script!B > " + moduleB;

				equal(
					t.definedB,
					"DEFINED: require/script!B",
					"define(\"require/script!B\", ... ); --> require/script!B was defined"
				);

				equal(
					t.loadedB,
					"LOADED: require/script!B > SCRIPT MODULE B",
					"define(\"require/script!B\", ... ); --> require/script!B was loaded as module object"
				);

				start();
			});
		});

		asyncTest("require(\"script!\"); define(\"script!\")", function() {
			require(["script!C"], function(moduleC){
				t.loadedC = "LOADED: script!C > " + moduleC;

				equal(
					t.definedC,
					"DEFINED: script!C",
					"define(\"script!C\", ... ); --> script!C was defined"
				);

				equal(
					t.loadedC,
					"LOADED: script!C > SCRIPT MODULE C",
					"define(\"script!C\", ... ); --> script!C was loaded as module object"
				);

				start();
			});
		});

		asyncTest("require(\"require/script!\"); define(\"script!\")", function() {
			require(["require/script!C"], function(moduleC){
				t.loadedC = "LOADED: script!C > " + moduleC;

				equal(
					t.definedC,
					"DEFINED: script!C",
					"define(\"script!C\", ... ); --> require/script!C was defined"
				);

				equal(
					t.loadedC,
					"LOADED: script!C > SCRIPT MODULE C",
					"define(\"script!C\", ... ); --> require/script!C was loaded as module object"
				);

				start();
			});
		});

		setTimeout(function(){
			define("script!C", [], function(){
				t.definedC = "DEFINED: script!C";
				return "SCRIPT MODULE C";
			});
		},300);

		asyncTest("require", function() {
			require([moduleName], function(mod){
				ok(true, moduleName + " loaded via require.");

				ok(mod, moduleName + " module object exists.");

				start();
			});
		});
	}());
	</script>
</body>
</html>